import os
import random
from telegram import Update
from telegram.ext import Application, CommandHandler, ContextTypes

#  拽 转 拽 住 (Environment Variable)
TOKEN = os.environ["BOT_TOKEN"]

def get_display_name(user):
    """专 @username  拽, 专转 first_name"""
    if user.username:
        return f"@{user.username}"
    return user.first_name

async def love(update: Update, context: ContextTypes.DEFAULT_TYPE):
    if not update.message.reply_to_message:
        await update.message.reply_text(
            " 拽  爪专 注砖转 /love 转 注 "
        )
        return
    
    lover = get_display_name(update.message.from_user)
    loved = get_display_name(update.message.reply_to_message.from_user)
    
    percent = random.randint(0, 100)

    # 住祝 ' 驻  
    if percent < 30:
        emoji = ""
    elif percent < 70:
        emoji = ""
    else:
        emoji = ""

    await update.message.reply_text(
        f"{emoji}    {lover} -{loved} : {percent}%!"
    )

def main():
    app = Application.builder().token(TOKEN).build()
    app.add_handler(CommandHandler("love", love))

    print(" 注... ")
    app.run_polling()

if __name__ == "__main__":
    main()
